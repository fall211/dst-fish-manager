#!/usr/bin/env fish
# DST Fish Manager Wrapper

set SCRIPT_DIR (dirname (dirname (dirname (status --current-filename))))
set PYTHON_SCRIPT "$SCRIPT_DIR/main.py"
set VENV_PATH "$SCRIPT_DIR/.venv"

if not test -f "$PYTHON_SCRIPT"
    echo "Error: main.py not found at $PYTHON_SCRIPT"
    exit 1
end

# Use venv python if available, otherwise use system python3
if test -f "$VENV_PATH/bin/python3"
    "$VENV_PATH/bin/python3" "$PYTHON_SCRIPT" $argv
else if test -f "$VENV_PATH/bin/python"
    "$VENV_PATH/bin/python" "$PYTHON_SCRIPT" $argv
else
    if not command -v python3 &> /dev/null
        echo "Error: python3 not available and venv not found"
        echo "Please create a virtual environment with: python3 -m venv $VENV_PATH"
        echo "Then install requirements with: $VENV_PATH/bin/pip install -r $SCRIPT_DIR/requirements.txt"
        exit 1
    end
    python3 "$PYTHON_SCRIPT" $argv
end
